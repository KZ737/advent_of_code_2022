import numpy as np
â¬…ï¸ğŸ’¾ = open("./day_14/input.txt", "r")

ğŸŸ«ğŸ’¾ = []
for â– in â¬…ï¸ğŸ’¾:
    ğŸ’¾ = [list(map(int, ğŸ“ˆ.split(","))) for ğŸ“ˆ in â–.strip().split(" -> ")]
    if ğŸ’¾ not in ğŸŸ«ğŸ’¾:
        ğŸŸ«ğŸ’¾.append(ğŸ’¾)

ğŸš¦âšª = [500, 0]
ğŸš§ = [ğŸš¦âšª.copy(), ğŸš¦âšª.copy()]
for ğŸŸ« in ğŸŸ«ğŸ’¾:
    for â­ in ğŸŸ«:
        ğŸš§[0][0] = min(ğŸš§[0][0], â­[0])
        ğŸš§[0][1] = min(ğŸš§[0][1], â­[1])
        ğŸš§[1][0] = max(ğŸš§[1][0], â­[0])
        ğŸš§[1][1] = max(ğŸš§[1][1], â­[1])
ğŸš§[1][1] += 2

ğŸ”ƒ = ğŸš§[1][1] - ğŸš§[0][1]
if ğŸ”ƒ > (ğŸš¦âšª[0]-ğŸš§[0][0]):
    ğŸš§[0][0] -= (ğŸ”ƒ - (ğŸš¦âšª[0] - ğŸš§[0][0]))
if ğŸ”ƒ > (ğŸš§[1][0] - ğŸš¦âšª[0]):
    ğŸš§[1][0] += (ğŸ”ƒ - (ğŸš§[1][0] - ğŸš¦âšª[0]))
ğŸš¦âšª = [ğŸš¦âšª[0] - ğŸš§[0][0], ğŸš¦âšª[1] - ğŸš§[0][1]]

ğŸŸ«ğŸ—ºï¸ = np.full((ğŸš§[1][1]-ğŸš§[0][1]+1, ğŸš§[1][0]-ğŸš§[0][0]+1), fill_value="ğŸŸ¦", dtype=np.str_)
for ğŸŸ« in ğŸŸ«ğŸ’¾:
    ğŸš¦â­ = ğŸŸ«[0]
    for â­ in ğŸŸ«[1:]:
        ğŸŸ«ğŸš¦ = [min(ğŸš¦â­[0]-ğŸš§[0][0], â­[0]-ğŸš§[0][0]), min(ğŸš¦â­[1]-ğŸš§[0][1], â­[1]-ğŸš§[0][1])]
        ğŸŸ«ğŸ = [max(ğŸš¦â­[0]-ğŸš§[0][0], â­[0]-ğŸš§[0][0]), max(ğŸš¦â­[1]-ğŸš§[0][1], â­[1]-ğŸš§[0][1])]
        ğŸŸ«ğŸ—ºï¸[ğŸŸ«ğŸš¦[1]:ğŸŸ«ğŸ[1]+1,ğŸŸ«ğŸš¦[0]:ğŸŸ«ğŸ[0]+1] = "ğŸŸ«"
        ğŸš¦â­ = â­

ğŸš§ = [[0, 0], [ğŸš§[1][0]-ğŸš§[0][0], ğŸš§[1][1] - ğŸš§[0][1]]]
ğŸŸ«ğŸ—ºï¸[ğŸš§[1][1], :] = 1

class ğŸŸ¨:
    def __init__(self, ğŸš¦ğŸ“ˆ, ğŸŸ«ğŸ—ºï¸):
        self.ğŸ“ˆ = ğŸš¦ğŸ“ˆ
        ğŸŸ«ğŸ—ºï¸[self.ğŸ“ˆ[1], self.ğŸ“ˆ[0]] = "ğŸŸ¨"

    def ğŸŸ¨â¬‡ï¸(self, ğŸ†•ğŸ“ˆ, ğŸŸ«ğŸ—ºï¸):
        # ğŸŸ«ğŸ—ºï¸[*list(reversed(self.ğŸ“ˆ))] = "ğŸŸ¦"
        ğŸŸ«ğŸ—ºï¸[self.ğŸ“ˆ[1], self.ğŸ“ˆ[0]] = "ğŸŸ¦"
        self.ğŸ“ˆ = ğŸ†•ğŸ“ˆ
        ğŸŸ«ğŸ—ºï¸[self.ğŸ“ˆ[1], self.ğŸ“ˆ[0]] = "ğŸŸ¨"
        # ğŸŸ«ğŸ—ºï¸[*list(reversed(self.ğŸ“ˆ))] = "ğŸŸ¨"

    def â¬‡ï¸1ï¸âƒ£(self, ğŸŸ«ğŸ—ºï¸, ğŸš§):
        if self.ğŸ“ˆ[1] == ğŸš§[1][1]:
            return 2
        if ğŸŸ«ğŸ—ºï¸[self.ğŸ“ˆ[1]+1, self.ğŸ“ˆ[0]] == "ğŸŸ¦":
            self.ğŸŸ¨â¬‡ï¸([self.ğŸ“ˆ[0], self.ğŸ“ˆ[1]+1], ğŸŸ«ğŸ—ºï¸)
            return 0
        if self.ğŸ“ˆ[0] > ğŸš§[0][0]:
            if ğŸŸ«ğŸ—ºï¸[self.ğŸ“ˆ[1]+1, self.ğŸ“ˆ[0]-1] == "ğŸŸ¦":
                self.ğŸŸ¨â¬‡ï¸([self.ğŸ“ˆ[0]-1, self.ğŸ“ˆ[1]+1], ğŸŸ«ğŸ—ºï¸)
                return 0        
            if self.ğŸ“ˆ[0] < ğŸš§[1][0]:
                if ğŸŸ«ğŸ—ºï¸[self.ğŸ“ˆ[1]+1, self.ğŸ“ˆ[0]+1] == "ğŸŸ¦":
                    self.ğŸŸ¨â¬‡ï¸([self.ğŸ“ˆ[0]+1, self.ğŸ“ˆ[1]+1], ğŸŸ«ğŸ—ºï¸)
                    return 0
                else:
                    return 1
        return 2

    def â¬‡ï¸ğŸ›‘(self, ğŸŸ«ğŸ—ºï¸, ğŸš§):
        while True:
            â¬‡ï¸ = self.â¬‡ï¸1ï¸âƒ£(ğŸŸ«ğŸ—ºï¸, ğŸš§)
            if â¬‡ï¸ == 0:
                continue
            else:
                return â¬‡ï¸

ğŸŸ¨ğŸ§® = 0
while True:
    ğŸŸ¨ğŸ§® += 1
    ğŸ†•ğŸŸ¨ = ğŸŸ¨(ğŸš¦âšª, ğŸŸ«ğŸ—ºï¸)
    ğŸ›‘ = ğŸ†•ğŸŸ¨.â¬‡ï¸ğŸ›‘(ğŸŸ«ğŸ—ºï¸, ğŸš§)
    if ğŸ†•ğŸŸ¨.ğŸ“ˆ[1] == 0:
        break
    else:
        continue

print(ğŸŸ¨ğŸ§®)

â¬…ï¸ğŸ’¾.close()

â¡ï¸ğŸ’¾ = open("./day_14/output.txt", "w", encoding="utf-8")
np.set_printoptions(threshold=np.inf)
â¡ï¸ğŸ’¾.write(np.array2string(ğŸŸ«ğŸ—ºï¸, max_line_width=np.inf, separator='', formatter={"str_kind": lambda x: x}))
â¡ï¸ğŸ’¾.close()